<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Life Moments</title>

  <!-- æµè§ˆå™¨ Tab å›¾æ ‡ï¼ˆå°ç‹—ï¼‰ -->
  <link rel="icon" type="image/png" href="images/icon.jpg" />
  <link rel="shortcut icon" type="image/png" href="images/icon.jpg" />
  <link rel="apple-touch-icon" href="images/icon.jpg" />

  <style>
    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: transparent;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }

    /* ğŸŒˆ æœ€åº•å±‚æµå…‰èƒŒæ™¯ */
    #flow-bg {
      position: fixed;
      inset: 0;
      z-index: -10;
      background:
        linear-gradient(120deg,
          rgba(255,183,197,0.55),
          rgba(148,187,233,0.55),
          rgba(255,215,140,0.55),
          rgba(182,140,255,0.55)
        );
      background-size: 400% 400%;
      animation: flow 14s ease infinite;
      filter: blur(40px);
    }
    @keyframes flow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* ğŸŒ«ï¸ ç¬¬äºŒå±‚ï¼šå½“å‰ç…§ç‰‡æ¨¡ç³ŠèƒŒæ™¯ */
    #bg-blur {
      position: fixed;
      inset: 0;
      z-index: -5;
      background-size: cover;
      background-position: center;
      filter: blur(30px) brightness(0.9);
      opacity: 0.65;
      transform: scale(1.1);
      transition: background-image 0.6s ease;
    }

    /* ğŸ”„ é¦–å±åŠ è½½è’™å±‚ */
    #loading-overlay {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at 20% 20%, #2b2b40, #000000 65%);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      color: #fff;
      transition: opacity 0.6s ease;
    }
    #loading-overlay.hide {
      opacity: 0;
      pointer-events: none;
    }
    .loading-box {
      text-align: center;
      padding: 20px 28px;
      border-radius: 18px;
      background: rgba(0,0,0,0.55);
      backdrop-filter: blur(14px);
    }
    .loader {
      width: 46px;
      height: 46px;
      border-radius: 50%;
      border: 3px solid rgba(255,255,255,0.2);
      border-top-color: #fff;
      margin: 0 auto 12px;
      animation: spin 1s linear infinite;
    }
    .loading-text {
      margin: 0;
      font-size: 15px;
    }
    .loading-tip {
      margin: 6px 0 0;
      font-size: 12px;
      opacity: 0.8;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* â­ é¡¶éƒ¨æ ‡é¢˜ï¼ˆå°ç‹— Logoï¼‰ */
    header {
      position: absolute;
      top: 30px;
      left: 50%;
      transform: translateX(-50%);
      padding: 14px 26px;
      background: rgba(0,0,0,0.55);
      border-radius: 18px;
      backdrop-filter: blur(14px);
      color: #fff;
      z-index: 10;
    }
    .title-wrap {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .logo {
      width: 42px;
      height: 42px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid rgba(255,255,255,0.6);
      box-shadow: 0 0 6px rgba(0,0,0,0.35);
    }
    .title-text h1 {
      margin: 0;
      font-size: 1.9em;
    }
    .title-text p {
      margin: 4px 0 0;
      font-size: 0.9em;
    }

    /* è½®æ’­ä¸»ä½“ */
    .slider {
      position: relative;
      width: 100%;
      height: 100%;
      z-index: 1;
    }

    .slides img {
      position: absolute;
      top: 50%;
      left: 50%;
      height: 100%;
      width: auto;
      transform: translate(-50%, -50%) scale(1);
      object-fit: cover;
      opacity: 0;
      transition: opacity 1s ease, transform 6s ease;
    }
    .slides img.active {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1.06);
    }

    /* å·¦å³æŒ‰é’® */
    .prev, .next {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 52px;
      height: 52px;
      background: rgba(255,255,255,0.22);
      backdrop-filter: blur(12px);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2em;
      cursor: pointer;
      color: #fff;
      z-index: 10;
    }
    .prev { left: 25px; }
    .next { right: 25px; }

    /* ç¼©ç•¥å›¾ */
    .thumbnails {
      position: absolute;
      bottom: 25px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 14px;
      z-index: 10;
    }
    .thumbnails img {
      width: 76px;
      height: 48px;
      border-radius: 7px;
      object-fit: cover;
      opacity: .55;
      transition: .3s;
      border: 2px solid transparent;
      cursor: pointer;
    }
    .thumbnails img.active {
      opacity: 1;
      transform: scale(1.12);
      border-color: #2ea5ff;
    }

    /* å·¦ä¸‹è§’ä¿¡æ¯ */
    .info-box {
      position: absolute;
      bottom: 110px;
      left: 40px;
      padding: 14px 16px;
      background: rgba(0,0,0,0.55);
      color: #fff;
      border-radius: 16px;
      backdrop-filter: blur(12px);
      z-index: 10;
      max-width: 320px;
    }
    .info-date {
      font-size: 0.85em;
      opacity: 0.85;
    }
    .info-caption {
      margin-top: 6px;
      font-size: 1em;
    }
    .info-index {
      margin-top: 6px;
      font-size: 0.8em;
      opacity: 0.7;
    }

    /* ç®€å•æ‰‹æœºé€‚é… */
    @media (max-width: 768px) {
      header {
        width: 85%;
        padding: 10px 18px;
      }
      .title-text h1 {
        font-size: 1.5em;
      }
      .info-box {
        left: 50%;
        bottom: 90px;
        transform: translateX(-50%);
        max-width: 80%;
        font-size: 0.9em;
      }
      .prev, .next {
        width: 44px;
        height: 44px;
        font-size: 1.6em;
      }
    }
  </style>
</head>

<body>
  <!-- é¦–å±åŠ è½½è’™å±‚ -->
  <div id="loading-overlay">
    <div class="loading-box">
      <div class="loader"></div>
      <p class="loading-text">æ­£åœ¨ä¸ºä½ åŠ è½½ç…§ç‰‡â€¦</p>
      <p class="loading-tip">ç…§ç‰‡æœ‰ç‚¹å¤šï¼Œç¨ç­‰ä¸€ä¸‹ä¸‹å“¦ï½</p>
    </div>
  </div>

  <!-- æµå…‰èƒŒæ™¯ + æ¨¡ç³ŠèƒŒæ™¯ -->
  <div id="flow-bg"></div>
  <div id="bg-blur"></div>

  <!-- æ ‡é¢˜æ ï¼šå°ç‹— + æ ‡é¢˜ + å‰¯æ ‡é¢˜ -->
  <header>
    <div class="title-wrap">
      <div class="title-text">
        <h1>Life Moments</h1>
        <p>æ„¿æˆ‘ä»¬çš„ç”Ÿæ´»åƒè¿™äº›ç…§ç‰‡ä¸€æ ·ç¾å¥½</p>
      </div>
    </div>
  </header>

  <!-- ä¸»è½®æ’­ -->
  <div class="slider">
    <div class="slides"></div>
    <div class="prev">&#10094;</div>
    <div class="next">&#10095;</div>
    <div class="thumbnails"></div>

    <div class="info-box">
      <div class="info-date" id="infoDate"></div>
      <div class="info-caption" id="infoCaption"></div>
      <div class="info-index" id="infoIndex"></div>
    </div>
  </div>

  <!-- èƒŒæ™¯éŸ³ä¹ï¼ˆæ”¾ä½ è‡ªå·±çš„é’¢ç´æ›² audio/bgm.wavï¼‰ -->
  <audio id="bgm" src="audio/bgm.wav" loop></audio>

  <script>
    // ========= é…ç½® =========
    const folder = "images/";
    const photos = [
      { file:"pic1.jpg", date:"2024 Â· æ˜¥å¤©",    caption:"å’Œå®å®ç¬¬ä¸€æ¬¡ç©çƒ" },
      { file:"pic2.jpg", date:"2024 Â· å¤å¤©",    caption:"åˆåæ¸©æš–çš„ä½ " },
      { file:"pic3.jpg", date:"2024 Â· ç§‹å¤©",    caption:"ä¸€èµ·æ•£æ­¥çš„é»„æ˜" },
      { file:"pic4.jpg", date:"2024 Â· å†¬å¤©",    caption:"çªåœ¨æ²™å‘ä¸Šçš„ä½ " },
      { file:"pic5.jpg", date:"æŸä¸€å¤©",        caption:"çœ‹ç€ä½ çªç„¶å¾ˆæƒ³ä½ " },
      { file:"pic6.jpg", date:"ä»¥å Â· æ¯ä¸€å¤©", caption:"æ„¿æˆ‘ä»¬çš„ç”Ÿæ´»åƒè¿™äº›ç…§ç‰‡ä¸€æ ·ç¾å¥½" }
    ];
    const totalImages = photos.length;

    // ========= DOM å¼•ç”¨ =========
    const slides = document.querySelector(".slides");
    const thumbs = document.querySelector(".thumbnails");
    const bgBlur = document.getElementById("bg-blur");
    const loadingOverlay = document.getElementById("loading-overlay");
    const infoDate = document.getElementById("infoDate");
    const infoCaption = document.getElementById("infoCaption");
    const infoIndex = document.getElementById("infoIndex");

    let index = 0;
    let timer = null;
    let resumeTimer = null;
    let firstMainLoaded = false;

    // ========= ç”Ÿæˆå›¾ç‰‡ï¼Œå¹¶å¤„ç†é¦–å¼ åŠ è½½å®Œæˆéšè—è’™å±‚ =========
    photos.forEach((p, i) => {
      const img = document.createElement("img");
      img.className = "";
      img.alt = p.caption || "";
      if (i === 0) img.classList.add("active");

      // é¦–å¼ å¤§å›¾åŠ è½½å®Œåéšè— loading
      if (i === 0) {
        img.onload = () => {
          if (!firstMainLoaded) {
            firstMainLoaded = true;
            loadingOverlay.classList.add("hide");
            setTimeout(() => loadingOverlay.remove(), 700);
          }
        };
      }

      img.src = folder + p.file;  // onload å·²æŒ‚å¥½ï¼Œå†èµ‹ src
      slides.appendChild(img);

      // ç¼©ç•¥å›¾
      const t = document.createElement("img");
      t.src = folder + p.file;
      t.dataset.idx = i;
      if (i === 0) t.classList.add("active");
      thumbs.appendChild(t);
    });

    const slideImgs = document.querySelectorAll(".slides img");
    const thumbImgs = document.querySelectorAll(".thumbnails img");

    // å…œåº•ï¼šæœ€å¤šç­‰ 6 ç§’è‡ªåŠ¨å…³é—­ loading
    setTimeout(() => {
      if (!firstMainLoaded) {
        loadingOverlay.classList.add("hide");
        setTimeout(() => loadingOverlay.remove(), 700);
      }
    }, 6000);

    // ========= æ˜¾ç¤ºæŒ‡å®šä¸‹æ ‡çš„å›¾ç‰‡ =========
    function updateInfo(i) {
      const p = photos[i];
      infoDate.textContent = p.date;
      infoCaption.textContent = p.caption;
      infoIndex.textContent = `${i + 1} / ${totalImages}`;
    }

    function show(i) {
      slideImgs.forEach((img, j) => img.classList.toggle("active", j === i));
      thumbImgs.forEach((img, j) => img.classList.toggle("active", j === i));
      index = i;

      bgBlur.style.backgroundImage = `url(${folder}${photos[i].file})`;
      updateInfo(i);
    }

    // åˆå§‹åŒ–é¦–å¼ 
    if (totalImages > 0) {
      bgBlur.style.backgroundImage = `url(${folder}${photos[0].file})`;
      updateInfo(0);
    }

    // ========= è‡ªåŠ¨è½®æ’­ + ç”¨æˆ·æ“ä½œæš‚åœæ¢å¤ =========
    function startAuto() {
      clearInterval(timer);
      timer = setInterval(() => {
        show((index + 1) % totalImages);
      }, 6000);
    }

    function userAction() {
      clearInterval(timer);
      clearTimeout(resumeTimer);
      resumeTimer = setTimeout(startAuto, 3000); // 3 ç§’åæ¢å¤è‡ªåŠ¨è½®æ’­
    }

    // å·¦å³æŒ‰é’®
    document.querySelector(".prev").onclick = () => {
      show((index - 1 + totalImages) % totalImages);
      userAction();
    };
    document.querySelector(".next").onclick = () => {
      show((index + 1) % totalImages);
      userAction();
    };

    // ç¼©ç•¥å›¾ç‚¹å‡»
    thumbImgs.forEach(t => {
      t.onclick = () => {
        const i = parseInt(t.dataset.idx, 10);
        show(i);
        userAction();
      };
    });

    // æ‰‹æœºç®€å•æ»‘åŠ¨åˆ‡æ¢
    let startX = 0;
    document.body.addEventListener("touchstart", e => {
      startX = e.touches[0].clientX;
    });
    document.body.addEventListener("touchend", e => {
      const endX = e.changedTouches[0].clientX;
      if (endX - startX > 80) {
        show((index - 1 + totalImages) % totalImages);
        userAction();
      } else if (startX - endX > 80) {
        show((index + 1) % totalImages);
        userAction();
      }
    });

    // ========= èƒŒæ™¯éŸ³ä¹ï¼šPC å°è¯•è‡ªåŠ¨æ’­æ”¾ï¼Œç§»åŠ¨ç«¯é¦–ç‚¹æ’­æ”¾ =========
    window.addEventListener("load", () => {
      const bgm = document.getElementById("bgm");
      if (!bgm) return;
      bgm.volume = 0.35;
      bgm.play().catch(() => {});
    });

    function enableBgm() {
      const bgm = document.getElementById("bgm");
      if (!bgm) return;
      bgm.volume = 0.35;
      bgm.play().catch(() => {});
      document.removeEventListener("click", enableBgm);
    }
    document.addEventListener("click", enableBgm);

    // å¯åŠ¨è‡ªåŠ¨è½®æ’­
    if (totalImages > 1) {
      startAuto();
    }
  </script>
</body>
</html>
